<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Patient Registration Page</title>
    <link rel="stylesheet" href="../static/css/styles.css">
    <link rel="icon" href="../static/images/logo.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="header_bar">
        <h2>Patient Registration Form:</h2>
        <div class="top_right_buttons">
            <form action="/all" class="custom_form">
                <button class="header_button">
                    <i class="fa-solid fa-users fa-xl"></i>
                </button>
            </form>
        </div>
        <div class="top_left_buttons">
            <form action="/" class="custom_form">
                <button class="header_button">
                    <i class="fa-solid fa-house fa-xl"></i>
                </button>
            </form>
        </div>
    </header>
    <div class="container">
        <div class="left">
            <form id="register_form">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" placeholder="Name" required>

                <label for="surname">Surname</label>
                <input type="text" id="surname" name="surname" placeholder="Surname" required>

                <label for="age">Age</label>
                <input type="text" id="age" name="age" placeholder="Age" required>

                <label for="gender">Gender</label>
                <select id="gender" name="gender" required>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    {#
                    <option value="Other">Other</option>#}
                </select>

                <label for="blood_type">Blood Type</label>
                <select id="blood_type" name="blood_type" required>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                </select>

                <label for="allergies">Allergies</label>
                <select id="allergies" name="allergies" required onchange="toggle_other_field('allergies', 'other_allergy')">
                    <option value="None">None</option>
                    <option value="Animals allergy">Animals allergy</option>
                    <option value="Lactose allergy">Lactose allergy</option>
                    <option value="Peanut allergy">Peanut allergy</option>
                    <option value="Latex allergy">Latex allergy</option>
                    <option value="Insect sting allergy">Insect sting allergy</option>
                    <option value="Pollen allergy">Pollen allergy</option>
                    <option value="Other">Other</option>
                </select>
                <input type="text" id="other_allergy" name="other_allergy" placeholder="Specify allergy" style="display: none;">

                <label for="diseases">Diseases</label>
                <select id="diseases" name="diseases" required onchange="toggle_other_field('diseases', 'other_disease')">
                    <option value="None">None</option>
                    <option value="Diabetes">Diabetes</option>
                    <option value="Hypertension">Hypertension</option>
                    <option value="Heart disease">Heart disease</option>
                    <option value="Epilepsy">Epilepsy</option>
                    <option value="Parkinson's disease">Parkinson's disease</option>
                    <option value="Alzheimer's disease">Alzheimer's disease</option>
                    <option value="Other">Other</option>
                </select>
                <input type="text" id="other_disease" name="other_disease" placeholder="Specify disease" style="display: none;">

                <label for="on_medication">Is the patient on medication?</label>
                <input type="checkbox" id="on_medication" name="on_medication"><br><br>

                <label for="priority"> How dangerous is the case ?</label>
                <select id="priority" name="priority">
                    <option value="0"> Minor</option>
                    <option value="1"> Serious</option>
                    <option value="2"> Fatal </option>
                    <option value="3"> For system to analize </option>
                </select>

                <div class="submit_container">
                    <input type="submit" value="Register">
                </div>
            </form>
            {#    <form class="submit_container" action="/body_injuries">
                #}
                {#        <input type="submit" value="Next">#}
                {#
            </form>#}
            {#    <form class="submit_container" action="/all">
                #}
                {#        <input type="submit" value="ALL PATIENTS">#}
                {#
            </form>#}
        </div>
        <div class="right">
            <div id="svg_container">
                <svg id="human_body_svg" width="612" height="612" viewBox="0 0 612 612" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <g>
                        <image width="612" height="612" preserveAspectRatio="none" xlink:href="/static/images/human_body_model.jpg" />
                        <path class="back_right_thigh" data-body-part="back_right_thigh" d="m486.3 333.2 0.2177 9.395-0.0247 6.603-0.3506 5.405-0.1845 5.438s-0.5393 5.858-0.4694 5.648c0.07-0.2099-0.5068 6.113-0.5068 6.113s-0.6008 6.092-0.6008 6.372c0 0.2799-1.297 8.769-1.297 8.769l-0.9542 7.451-0.9832 6.661-1.284 7.294-1.697 5.318-1.634 5.678-1.259 5.384-1.411 6.022-0.813 3.659-5.101 0.346h-16.31l-10.2-0.346s-0.8182-9.323-0.8182-9.603c0-0.2799-0.7348-7.103-0.8048-7.383-0.07-0.2799-0.1749-6.613-0.1749-6.613l-0.14-2.869-0.8048-9.272-0.6298-8.817-0.035-8.362 0.035-4.409-0.07-6.928 0.07-5.248 0.035-3.954-0.105-6.193 0.2099-7.033-0.07-6.928-0.07-3.744 0.0205-3.85z" style="fill:#f00;stroke-width:.7559" />
                        <path class="back_left_thigh" data-body-part="back_left_thigh" d="m388.8 333.2-0.2177 9.395 0.0247 6.603 0.3506 5.405 0.1845 5.438s0.5393 5.858 0.4694 5.648c-0.07-0.2099 0.5068 6.113 0.5068 6.113s0.6008 6.092 0.6008 6.372c0 0.2799 1.297 8.769 1.297 8.769l0.9542 7.451 0.9832 6.661 1.284 7.294 1.697 5.318 1.634 5.678 1.259 5.384 2.104 6.121 0.6995 3.346 4.521 0.56h16.31l9.757-0.56s1.265-9.109 1.265-9.389c0-0.2799 0.7348-7.103 0.8048-7.383 0.07-0.2799 0.1749-6.613 0.1749-6.613l0.14-2.869 0.8048-9.272 0.6298-8.817 0.035-8.362-0.035-4.409 0.07-6.928-0.07-5.248-0.035-3.954 0.105-6.193-0.2099-7.033 0.07-6.928 0.07-3.744-0.0205-3.85z" style="fill:#f00;stroke-width:.7559" />
                        <path class="front_left_thigh" data-body-part="front_left_thigh" d="m225.2 333.2 0.2177 9.395-0.0247 6.603-0.3506 5.405-0.1845 5.438s-0.5393 5.858-0.4694 5.648c0.07-0.2099-0.5068 6.113-0.5068 6.113s-0.6008 6.092-0.6008 6.372c0 0.2799-1.297 8.769-1.297 8.769l-0.9542 7.451-0.9832 6.661-1.284 7.294-1.697 5.318-1.634 5.678-1.259 5.384-2.104 6.121-0.6645 3.906h-4.556-26.66s-0.6698-9.669-0.6698-9.949c0-0.2799-0.7348-7.103-0.8048-7.383-0.07-0.2799-0.1749-6.613-0.1749-6.613l-0.14-2.869-0.8048-9.272-0.6298-8.817-0.035-8.362 0.035-4.409-0.07-6.928 0.07-5.248 0.035-3.954-0.105-6.193 0.2099-7.033-0.07-6.928-0.07-3.744 0.0205-3.85z" style="fill:#f00;stroke-width:.7559" />
                        <path class="back_pelvis" data-body-part="back_pelvis" d="m389 332.6 45.56-0.8172 5.388 0.2099 46.4 0.6073-0.8398-16.56-1.26-10.22-1.959-10.5-0.3499-3.499-12.32-0.2099s-9.377 0.2099-11.62 0.2099-19.03 0.14-19.03 0.14-11.91-0.4591-13.58-0.2099l-12.53 0.07-11.13-0.07-4.269-0.07h-3.779l-2.029 10.78s-1.47 8.118-1.47 9.237-0.6298 7.908-0.6298 7.908l-0.4898 6.368z" style="fill:#f00" />
                        <rect x="490.2" y="136.7" width=".3" height="55.82" rx="1.328" ry=".9097" />
                        <rect x="384.8" y="136.5" width=".3" height="55.82" rx="1.328" ry=".9097" />
                        <path class="front_lower_right_hand" data-body-part="front_lower_right_hand" d="m90.69 244.7-2.729 8.188-2.169 6.578-2.029 6.648-1.61 7.978-0.9097 8.817-0.6298 7.348-1.26 15.54-0.9797 9.657-3.079 3.149-4.409 4.129-3.989 3.779-3.429 5.458-3.499 6.928-0.3499 2.589 1.959 1.19 3.149-1.61 6.508-8.957 1.12 1.54-2.099 4.759-6.298 18.26-0.9097 3.009 1.33 1.679 2.589-0.2799 2.099-3.009 5.178-15.68 1.19-0.4199 0.9797 0.8398-0.6298 2.729-4.829 17.14v2.799l1.679 1.68 1.959-0.6998 1.33-2.519 5.178-18.54 1.12-0.6298 0.9097 0.6998-0.6298 2.519-2.659 13.93v2.589l1.679 0.9797 1.889-0.5598 1.33-2.379 3.429-17.07 0.9797-0.9097 0.9797 0.8397-0.3499 2.869-0.3499 4.829-0.9097 8.188 1.33 1.33 2.309-0.6998 0.9097-2.169 3.219-15.89 2.029-7.838-0.06998-18.4 8.258-24.14 7.208-17.28 1.47-9.307 1.4-21.13z" style="fill:#f00;stroke-width:6.671" />
                        <path class="back_lower_left_hand" data-body-part="back_lower_left_hand" d="m352.2 244.9-2.729 8.188-2.169 6.578-2.029 6.648-1.61 7.978-0.9097 8.817-0.6298 7.348-1.26 15.54-0.9797 9.657-3.079 3.149-4.409 4.129-3.989 3.779-3.429 5.458-3.499 6.928-0.3499 2.589 1.959 1.19 3.149-1.61 6.508-8.957 1.12 1.54-2.099 4.759-6.298 18.26-0.9097 3.009 1.33 1.679 2.589-0.2799 2.099-3.009 5.178-15.68 1.19-0.4199 0.9797 0.8398-0.6298 2.729-4.829 17.14v2.799l1.679 1.68 1.959-0.6998 1.33-2.519 5.178-18.54 1.12-0.6298 0.9097 0.6998-0.6298 2.519-2.659 13.93v2.589l1.679 0.9797 1.889-0.5598 1.33-2.379 3.429-17.07 0.9797-0.9097 0.9797 0.8397-0.3499 2.869-0.3499 4.829-0.9097 8.188 1.33 1.33 2.309-0.6998 0.9097-2.169 3.219-15.89 2.029-7.838-0.07-18.4 8.258-24.14 7.208-17.28 1.47-9.307 1.4-21.13z" style="fill:#f00;stroke-width:6.671" />
                        <path class="front_lower_left_hand" data-body-part="front_lower_left_hand" d="m262.2 244.9 2.729 8.188 2.169 6.578 2.029 6.648 1.61 7.978 0.9097 8.817 0.6298 7.348 1.26 15.54 0.9797 9.657 3.079 3.149 4.409 4.129 3.989 3.779 3.429 5.458 3.499 6.928 0.3499 2.589-1.959 1.19-3.149-1.61-6.508-8.957-1.12 1.54 2.099 4.759 6.298 18.26 0.9097 3.009-1.33 1.679-2.589-0.2799-2.099-3.009-5.178-15.68-1.19-0.4199-0.9797 0.8398 0.6298 2.729 4.829 17.14v2.799l-1.679 1.68-1.959-0.6998-1.33-2.519-5.178-18.54-1.12-0.6298-0.9097 0.6998 0.6298 2.519 2.659 13.93v2.589l-1.679 0.9797-1.889-0.5598-1.33-2.379-3.429-17.07-0.9797-0.9097-0.9797 0.8397 0.3499 2.869 0.3499 4.829 0.9097 8.188-1.33 1.33-2.309-0.6998-0.9097-2.169-3.219-15.89-2.029-7.838 0.07-18.4-8.258-24.14-7.208-17.28-1.47-9.307-1.4-21.13z" style="fill:#f00" />
                        <path class="back_lower_right_hand" data-body-part="back_lower_right_hand" d="m523.4 244.9 2.729 8.188 2.169 6.578 2.029 6.648 1.61 7.978 0.9097 8.817 0.6298 7.348 1.26 15.54 0.9797 9.657 3.079 3.149 4.409 4.129 3.989 3.779 3.429 5.458 3.499 6.928 0.3499 2.589-1.959 1.19-3.149-1.61-6.508-8.957-1.12 1.54 2.099 4.759 6.298 18.26 0.9097 3.009-1.33 1.679-2.589-0.2799-2.099-3.009-5.178-15.68-1.19-0.4199-0.9797 0.8398 0.6298 2.729 4.829 17.14v2.799l-1.679 1.68-1.959-0.6998-1.33-2.519-5.178-18.54-1.12-0.6298-0.9097 0.6998 0.6298 2.519 2.659 13.93v2.589l-1.679 0.9797-1.889-0.5598-1.33-2.379-3.429-17.07-0.9797-0.9097-0.9797 0.8397 0.3499 2.869 0.3499 4.829 0.9097 8.188-1.33 1.33-2.309-0.6998-0.9097-2.169-3.219-15.89-2.029-7.838 0.07-18.4-8.258-24.14-7.208-17.28-1.47-9.307-1.4-21.13z" style="fill:#f00;stroke-width:6.671" />
                        <path lass="front_higher_right_hand" data-body-part="front_higher_right_hand" d="m116.8 245.2-26.42-1.234 1.455-7.207 0.5938-28.11 1.781-14.84 2.573-17.02 1.781-16.43 5.938-12.07 11.88-9.897 7.323-2.771-0.1979 52.65v9.699l0.1979 6.334-0.7917 5.344-1.188 6.136-1.781 9.105-1.292 6.272-1.258 7.118z" style="fill:#f00" />
                        <rect transform="matrix(.9988 .04885 .003491 1 0 0)" x="88.9" y="239.5" width="28.14" height=".99" rx="14.02" ry="26.8" />
                        <rect transform="matrix(-.9988 .04885 -.003491 1 0 0)" x="-264.7" y="256.9" width="28.14" height=".99" rx="14.02" ry="26.8" />
                        <rect transform="matrix(-.9988 .04885 -.003491 1 0 0)" x="-526.1" y="269.5" width="28.14" height=".99" rx="14.02" ry="26.8" />
                        <rect transform="matrix(.9988 .04885 .003491 1 0 0)" x="351" y="226.7" width="28.14" height=".99" rx="14.02" ry="26.8" />
                        <path class="back_higher_left_hand" data-body-part="back_higher_left_hand" d="m378 245.2-26.42-1.234 1.455-7.207 0.5938-28.11 1.781-14.84 2.573-17.02 1.781-16.43 5.938-12.07 11.88-9.897 7.323-2.771-0.1979 52.65v9.699l0.1979 6.334-0.7917 5.344-1.188 6.136-1.781 9.105-1.292 6.272-1.258 7.118z" style="fill:#f00" />
                        <path class="front_higher_left_hand" data-body-part="front_higher_left_hand" d="m236.1 245.2 26.42-1.234-1.455-7.207-0.5938-28.11-1.781-14.84-2.573-17.02-1.781-16.43-5.938-12.07-11.88-9.897-7.323-2.771 0.1979 52.65v9.699l-0.1979 6.334 0.7917 5.344 1.188 6.136 1.781 9.105 1.292 6.272 1.258 7.118z" style="fill:#f00" />
                        <path class="back_higher_right_hand" data-body-part="back_higher_right_hand" d="m497.3 245.2 26.42-1.234-1.455-7.207-0.5938-28.11-1.781-14.84-2.573-17.02-1.781-16.43-5.938-12.07-11.88-9.897-7.323-2.771 0.1979 52.65v9.699l-0.1979 6.334 0.7917 5.344 1.188 6.136 1.781 9.105 1.292 6.272 1.258 7.118z" style="fill:#f00" />
                        <rect transform="matrix(.9988 .04885 .003491 1 0 0)" x="88.9" y="239.5" width="28.14" height=".99" rx="14.02" ry="26.8" />
                        <rect x="123.7" y="136.4" width=".3" height="55.82" rx="1.328" ry=".9097" />
                        <rect x="229" y="136.5" width=".3" height="55.82" rx="1.328" ry=".9097" />
                        <path class="front_head" data-body-part="front_head" d="m175.4 27.51 11.97 1.682 11.68 7.521 6.928 10.99 2.078 7.521-0.1979 25.93c-0.0242 3.167-1.979 11.48-1.979 11.48l-4.552 8.511-10.59 8.808-7.719 3.761-14.17 0.1739-9.358-4.802-7.07-6.785-5.835-9.095-1.88-10.93-0.8878-25.66 2.023-8.265 6.43-10.02 11.21-8.461z" style="fill:#f00" />
                        <path class="back_head" data-body-part="back_head" d="m437 27.28 11.97 1.682 11.68 7.521 6.928 10.99 2.078 7.521-0.1979 25.93c-0.0242 3.167-1.979 11.48-1.979 11.48l-4.552 8.511-10.59 8.808-7.719 3.761-14.17 0.1739-9.358-4.802-7.07-6.785-5.835-9.095-1.88-10.93-0.8878-25.66 2.023-8.265 6.43-10.02 11.21-8.461z" style="fill:#f00" />
                        <path class="front_neck" data-body-part="front_neck" d="m157.6 109.1 0.5478 12.6 1.921 2.749 4.345 1.467 12.92 0.6758 3.785-0.2099 5.986-0.2679 4.123-0.4998 2.057-1.246 1.477-2.075-0.1039-12.78-6.254 3.481-4.217 1.921-7.437 0.8836-5.32-0.3499-3.269-0.8356-5.39-2.515z" style="fill:#f00" />
                        <path class="back_neck" data-body-part="back_neck" d="m418.8 108.2 0.5478 12.6 1.921 2.749 4.345 1.467 12.92 0.6758 3.785-0.2099 5.986-0.2679 4.123-0.4998 2.057-1.246 1.477-2.075-0.1039-12.78-6.254 3.481-4.217 1.921-7.437 0.8836-5.32-0.3499-3.269-0.8356-5.39-2.515z" style="fill:#f00" />
                        <path class="front_chest" data-body-part="front_chest" d="m123.9 135.6 7.892-1.263 5.967-3.133 7.703-2.579 6.619-2.871 5.914-1.767 7.718 3.357 3.587 0.0789 8.017-0.2099c5.974-0.1564 12.58-0.5488 12.58-0.5488l6.034-1.954 2.986 0.9957 4.691 1.744 8.759 3.366 6.843 2.712 9.938 3.296-0.07 10.48-0.047 15.8-0.0339 26.69-1.31 4.697-2.871 6.649-3.927 2.311-5.954 1.642-4.969 0.5539-4.942-0.14-6.889-0.158-4.901-1.049-3.237-1.211-2.74-0.6238-3.703 1.234-4.434 0.9097-4.786 0.6888-4.525-0.8207-4.111-1.178-2.356-0.4199-3.505 1.675-5.19 1.015-3.296 0.2739h-4.972l-4.973-0.1919-4.035-0.5008-3.902-0.6807-3.831-1.991-3.565-4.05-1.64-4.849-0.4948-1.682-1e-5 -9.76-0.0124-7.101v-12.35l1e-5 -7.002 0.0124-7.175-0.0124-4.911z" style="fill:#f00" />
                        <path class="back_chest" data-body-part="back_chest" d="m385.1 135.6 7.892-1.263 5.967-3.133 7.703-2.579 6.619-2.871 5.914-1.767 7.718 3.357 3.587 0.0789 8.017-0.2099c5.974-0.1564 12.58-0.5488 12.58-0.5488l6.034-1.954 2.986 0.9957 5.461 1.744 7.989 2.946 6.633 2.712 9.938 2.456 0.1399 11.74-0.047 15.8-0.0339 26.69-1.31 4.697-2.871 6.649-3.927 2.311-5.954 1.642-4.969 0.5539-4.942-0.14-6.889-0.158-4.901-1.049-3.237-1.211-2.74-0.6238-3.703 1.234-4.434 0.9097-4.786 0.6888-4.525-0.8207-4.111-1.178-2.356-0.4199-3.505 1.675-5.19 1.015-3.296 0.2739h-4.972l-4.973-0.1919-4.035-0.5008-3.902-0.6807-3.831-1.991-3.565-4.05-1.64-4.849-0.4948-1.682-1e-5 -9.76-0.0124-7.101v-12.35l1e-5 -7.002 0.0124-7.175-0.0124-4.911z" style="fill:#f00" />
                        <path class="front_abdomen" data-body-part="front_abdomen" d="m127.9 203.8 8.556 3.455 9.1 0.6348 11.65-0.8352 7.778-2.713 8.212 1.886 8.907-0.8277 5.846-1.26 3.796 1.646 3.05 0.8257 6.565 1.153 7.253 0.1849 8.105-0.8727 7.301-3.228 0.2261 5-2.117 10.19-3.579 14.17-0.0689 12.44-0.1629 11.49-0.3499 11.93 0.8006 12.57 1.341 8.731-9.503 0.0825s-20.14 0.1259-20.93 0.1259-12.25 0.458-12.25 0.458l-12.79-0.5368-19.09 0.5608-12.77-0.6903 0.6799-7.042 1.369-11.68-0.3499-15.28-0.024-14.41-0.6048-7.475-1.048-8.01-1.863-5.681-2.725-10.23z" style="fill:#f00" />
                        <path class="back_abdomen" data-body-part="back_abdomen" d="m389.2 203.7 8.556 3.455 9.1 0.6348 11.65-0.8352 7.778-2.713 8.212 1.886 8.907-0.8277 5.846-1.26 3.796 1.646 3.05 0.8257 6.565 1.153 7.253 0.1849 8.105-0.8727 7.301-3.228 0.2261 5-2.117 10.19-3.579 14.17-0.0689 12.44-0.1629 11.49-0.3499 11.93 0.8006 12.57 1.341 8.732-9.503 0.0819s-20.14 0.1259-20.93 0.1259-12.25 0.458-12.25 0.458l-12.79-0.5368-19.09 0.5608-12.77-0.6897 0.6799-7.043 1.369-11.68-0.3499-15.28-0.024-14.41-0.6048-7.475-1.048-8.01-1.863-5.681-2.725-10.23z" style="fill:#f00" />
                        <path class="front_pelvis" data-body-part="front_pelvis" d="m127.2 331.5 45.95 0.2618 5.388 0.2099 46.4 0.6072-0.8398-16.56-1.26-10.22-1.959-10.5-0.3499-3.499-12.32-0.2099s-9.377 0.2099-11.62 0.2099-19.03 0.14-19.03 0.14-11.91-0.4591-13.58-0.2099l-12.53 0.07-11.13-0.07-4.269-0.07h-3.779l-2.029 10.78s-1.47 8.118-1.47 9.237-0.6298 7.908-0.6298 7.908l-0.4898 6.368z" style="fill:#f00" />
                        <rect x="388.8" y="331.5" width="97.53" height="1.831" />
                        <path class="front_lower_right_leg" data-body-part="front_lower_right_leg" d="m141.8 436.4-1.766 16.82-1.333 9.059-0.6064 15.6 2.889 17.83 4.622 21.72 2.684 10.35 3.137 12.4 0.8667 12.96-2.613 6.654-6.595 8.462-3.983 5.493-1.361 3.513 0.1979 2.227 1.509 1.039 2.004-0.1237 1.039-3.018 0.9402-0.6433 0.4206 0.4453 0.0742 1.138-0.0495 1.435 0.2969 1.163 0.7422 0.6185s1.357 0.1272 1.732 0c1.386-0.4701 1.287-1.856 1.287-1.856l1.064-1.707 0.4206-0.3958 0.5938 0.3216 0.1732 0.9896-0.1237 1.163 0.0495 1.287 0.6433 0.9402 2.326 0.099 1.089-0.9154 0.9402-3.266 1.138-0.8165 0.6928 0.4454-0.0247 1.93v1.262l0.4701 0.668 0.4454 0.9649 2.202 0.4206 1.93-0.2969 0.8165-0.767 1.361-4.627 0.6185-1.336 0.7917 0.0248 0.668 1.014s0.1237 0.6928 0.1237 1.386c0 0.6928-0.4701 1.831-0.4701 1.831l0.0495 1.361 1.509 1.237 2.746 0.8165 2.499-0.5196 1.856-1.608 0.3959-2.078s0.052-4.736 0.0247-5.765c-0.0176-0.6641 0.2227-0.6928 0.2227-1.386 0-0.6928 0.2722-5.517-0.4206-7.892-0.6928-2.375-0.1979-4.577-0.6928-5.963-0.4948-1.386-0.1484-8.61-0.1484-8.61s-0.9154-8.486-0.9154-10.49c0-1.089-0.0495-17.32-0.0495-17.32s0.0742-7.843 0.0742-8.635c0-0.7917 0.7175-9.451 0.7175-9.451l0.866-18.43 0.4454-8.907 0.1732-10.17-0.6433-9.253s-0.5691-6.26-0.5691-6.853-1.484-5.814-1.484-5.814l-0.2722-8.164z" style="fill:#f00" />
                        <path class="front_lower_left_leg" data-body-part="front_lower_left_leg" d="m211.1 436.4 1.172 16.82 1.333 9.059 0.6064 15.6-2.889 17.83-4.622 21.72-2.684 10.35-3.137 12.4-0.8667 12.96 2.613 6.654 6.595 8.462 3.983 5.493 1.361 3.513-0.1979 2.227-1.509 1.039-2.004-0.1237-1.039-3.018-0.9402-0.6433-0.4206 0.4453-0.0742 1.138 0.0495 1.435-0.2969 1.163-0.7422 0.6185s-1.357 0.1272-1.732 0c-1.386-0.4701-1.287-1.856-1.287-1.856l-1.064-1.707-0.4206-0.3958-0.5938 0.3216-0.1732 0.9896 0.1237 1.163-0.0495 1.287-0.6433 0.9402-2.326 0.099-1.089-0.9154-0.9402-3.266-1.138-0.8165-0.6928 0.4454 0.0247 1.93v1.262l-0.4701 0.668-0.4454 0.9649-2.202 0.4206-1.93-0.2969-0.8165-0.767-1.361-4.627-0.6185-1.336-0.7917 0.0248-0.668 1.014s-0.1237 0.6928-0.1237 1.386c0 0.6928 0.4701 1.831 0.4701 1.831l-0.0495 1.361-1.509 1.237-2.746 0.8165-2.499-0.5196-1.856-1.608-0.3959-2.078s-0.052-4.736-0.0247-5.765c0.0176-0.6641-0.2227-0.6928-0.2227-1.386 0-0.6928-0.2722-5.517 0.4206-7.892 0.6928-2.375 0.1979-4.577 0.6928-5.963 0.4948-1.386 0.1484-8.61 0.1484-8.61s0.9154-8.486 0.9154-10.49c0-1.089 0.0495-17.32 0.0495-17.32s-0.0742-7.843-0.0742-8.635c0-0.7917-0.7175-9.451-0.7175-9.451l-0.866-18.43-0.4454-8.907-0.1732-10.17 0.6433-9.253s0.5691-6.26 0.5691-6.853 1.484-5.814 1.484-5.814l0.2722-8.164z" style="fill:#f00" />
                        <rect x="180.2" y="434.5" width="31.27" height="1.831" />
                        <path class="back_lower_left_leg" data-body-part="back_lower_left_leg" d="m402.5 435.7 0.172 8.837-1.103 8.718-1.134 7.484-0.8722 10.19 0.4368 8.621 0.7393 6.688s1.003 5.579 1.003 6.139 1.704 7.476 1.704 7.476l2.366 10.56 2.18 9.938 2.906 10.98 1.286 5.499 1.22 7.739 0.1865 8.093-0.4106 7.046-2.041 2.987-3.367 2.644-2.906 1.458-5.073 3.433-1.886 1.867-0.2334 2.709 1.034 1.805 2.796 1.418 10.8 2.915 5.51 1.631 3.939 1.599 5.161 1.158s4.185-0.4736 4.53-0.9365c0.3619-0.4863 2.872-1.329 2.872-1.329l1.918-2.944 0.627-1.723-0.1286-9.848-1.814-7.129s-1.49-8.298-1.624-9.756c-0.1213-1.313 0.0572-5.351 0.0572-5.351l0.4369-12.25 0.1732-9.904 0.1484-7.896 0.4136-7.088 0.7895-6.273s0.4199-4.494 0.4199-5.474c0-0.9797-0.0177-8.06-0.0177-8.06s0.4044-10.51 0.4044-11.07 0.0162-7.684 0.0162-9.083 0.0657-5.615-0.2142-6.735c-0.2799-1.12-0.8228-7.848-0.8228-7.848l-0.5091-3.577-0.2804-5.785-1.196-9.572z" style="fill:#f00" />
                        <path class="back_lower_right_leg" data-body-part="back_lower_right_leg" d="m473.2 435.3-0.4689 9.233 1.103 8.718 1.134 7.484 0.8722 10.19-0.4368 8.621-0.7393 6.688s-1.003 5.579-1.003 6.139-1.704 7.476-1.704 7.476l-2.366 10.56-2.18 9.938-2.906 10.98-1.286 5.499-1.22 7.739-0.1865 8.093 0.4106 7.046 2.041 2.987 3.367 2.644 2.906 1.458 5.073 3.433 1.886 1.867 0.2334 2.709-1.034 1.805-2.796 1.418-10.8 2.915-5.51 1.631-3.939 1.599-5.161 1.158s-4.185-0.4736-4.53-0.9365c-0.3619-0.4863-2.872-1.329-2.872-1.329l-1.918-2.944-0.627-1.723 0.1286-9.848 1.814-7.129s1.49-8.298 1.624-9.756c0.1213-1.313-0.0572-5.351-0.0572-5.351l-0.4369-12.25-0.1732-9.904-0.1484-7.896-0.4136-7.088-0.7895-6.273s-0.4199-4.494-0.4199-5.474c0-0.9797 0.0177-8.06 0.0177-8.06s-0.4044-10.51-0.4044-11.07-0.0162-7.684-0.0162-9.083-0.0657-5.615 0.2142-6.735c0.2799-1.12 0.8228-7.848 0.8228-7.848l0.5091-3.577 0.2804-5.785 0.7013-9.969z" style="fill:#f00" />
                        <rect x="132.2" y="290.5" width="88.42" height="1.575" rx="25.1" ry="0" />
                        <rect x="132.2" y="290.5" width="88.42" height="1.831" rx="0" ry="0" />
                        <rect x="393.5" y="290.5" width="88.42" height="1.831" rx="0" ry="0" />
                        <path class="front_right_thigh" data-body-part="front_right_thigh" d="m127.1 333.2-0.2177 9.395 0.0247 6.603 0.3506 5.405 0.1845 5.438s0.5393 5.858 0.4694 5.648c-0.07-0.2099 0.5068 6.113 0.5068 6.113s0.6008 6.092 0.6008 6.372c0 0.2799 1.297 8.769 1.297 8.769l0.9542 7.451 0.9832 6.661 1.284 7.294 1.697 5.318 1.634 5.678 1.259 5.384 2.104 6.121 1.854 3.906h30.02s0.6698-9.669 0.6698-9.949c0-0.2799 0.7348-7.103 0.8048-7.383 0.07-0.2799 0.1749-6.613 0.1749-6.613l0.14-2.869 0.8048-9.272 0.6298-8.817 0.035-8.362-0.035-4.409 0.07-6.928-0.07-5.248-0.035-3.954 0.105-6.193-0.2099-7.033 0.07-6.928 0.07-3.744-0.0205-3.85z" style="fill:#f00;stroke-width:.7559" />
                        <rect x="127.1" y="331.5" width="98.09" height="1.831" />
                        <rect x="141.9" y="434.5" width="30.28" height="1.831" />
                        <rect x="402.4" y="434.2" width="30.78" height="1.831" />
                        <rect x="441.5" y="434.2" width="31.58" height="1.831" />
                    </g>
                </svg>
            </div>

            <form id="body_part_form" class="body_part_form" style="display: none;">
                <fieldset>
                    <legend id="form_legend">Injury Details</legend>

                    <div class="body_part_form_group">
                        <label for="textinput"> Short damage description </label>
                        <div>
                            <input id="textinput" name="textinput" type="text" required>
                            <div id="textinput_tooltip" class="tooltip" style="display: none;"> Required field!</div>
                        </div>
                    </div>

                    <div class="body_part_form_group">
                        <label for="textarea">Comment</label>
                        <div>
                            <textarea id="textarea" name="textarea"></textarea>
                        </div>
                    </div>

                    <div class="body_part_form_buttons_container">
                        <div>
                            <a hreff="#" id="body_part_form_group_ok_button" class="body_part_form_button">OK</a>
                            <a hreff="#" id="body_part_form_group_cancel_button" class="body_part_form_button">Cancel</a>
                        </div>
                    </div>

                </fieldset>
            </form>
        </div>
    </div>

    <script>
        function toggle_other_field(select_id, text_field_id) {
            const select_element = document.getElementById(select_id);
            const text_field = document.getElementById(text_field_id);

            if (select_element.value === 'Other') {
                text_field.style.display = 'block';
            } else {
                text_field.style.display = 'none';
                text_field.value = ''; 
            }
        }

        document.getElementById('register_form').addEventListener('submit', async function (event) {
            event.preventDefault(); 

            const name = document.getElementById('name').value;
            const surname = document.getElementById('surname').value;
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;
            const blood_type = document.getElementById('blood_type').value;
            const allergies = document.getElementById('allergies').value;
            const diseases = document.getElementById('diseases').value;
            const on_medication = document.getElementById('on_medication').checked ? 'Yes' : 'No';

            const other_allergy_text = document.getElementById('other_allergy').value;
            const final_allergy = allergies === 'Other' && other_allergy_text.trim() !== ''
                ? `${allergies}: ${other_allergy_text}`
                : allergies;

            const other_disease_text = document.getElementById('other_disease').value;
            const final_disease = diseases === 'Other' && other_disease_text.trim() !== ''
                ? `${diseases}: ${other_disease_text}`
                : diseases;
            const priority = document.getElementById('priority').value;

            const patient_data = {
                name,
                surname,
                age,
                gender,
                blood_type,
                allergies: final_allergy,
                diseases: final_disease,
                on_medication,
                priority
            };

            const svg_element = document.querySelector("svg");
            let svg_data = null;

            if (svg_element) {
                const new_svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                new_svg.setAttribute("width", svg_element.getAttribute("width"));
                new_svg.setAttribute("height", svg_element.getAttribute("height"));

                document.querySelectorAll('.selected').forEach(el => {
                    const clone = el.cloneNode(true);
                    new_svg.appendChild(clone);
                });

                svg_data = new XMLSerializer().serializeToString(new_svg);
            }

            const descriptions = Object.entries(body_part_data)
                .map(([body_part, data]) => `;Â» ${body_part.charAt(0).toUpperCase() + body_part.slice(1).replaceAll('_', ' ')};Description: ${data.description};Comment:  ${data.comment};`).join('');

            const form_data = {
                ...patient_data,
                svg_content: svg_data,   
                descriptions: descriptions 
            };

            try {
                const response = await fetch('/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(form_data)
                });

                const data = await response.json();
                if (data.message) {
                    alert('Patient registered, SVG, and descriptions saved successfully!');
                    document.getElementById('register_form').reset();


                    document.getElementById('allergies').value = 'None'; 
                    document.getElementById('other_allergy').value = ''; 
                    document.getElementById('diseases').value = 'None';
                    document.getElementById('other_disease').value = ''; 

                    toggle_other_field('allergies', 'other_allergy');
                    toggle_other_field('diseases', 'other_disease');

                    document.querySelectorAll(".selected").forEach(element => {
                        element.classList.remove("selected"); 
                        element.style.opacity = ""; 
                    });


                } else {
                    alert('Failed to register patient or save data.');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        });
    </script>

    <script>
        const body_part_data = {};

        document.querySelectorAll("path").forEach(path => {
            path.addEventListener("click", body_part_clicked);
        });

        function body_part_clicked(event) {
            const path_element = event.currentTarget;
            const body_part = path_element.dataset.bodyPart; 

            const is_already_highlighted = path_element.classList.contains("selected");

            document.getElementById('body_part_form').style.display = "block";
            document.getElementById('form_legend').innerText = `Details for ${body_part.replaceAll('_', ' ')}`;

            const existing_data = body_part_data[body_part] || { description: '', comment: '' };
            document.getElementById('textinput').value = existing_data.description;
            document.getElementById('textarea').value = existing_data.comment;

            document.getElementById('body_part_form_group_ok_button').onclick = function (e) {
                e.preventDefault();

                const tooltip = document.getElementById('textinput_tooltip');
                body_part_data[body_part] = {
                    description: document.getElementById('textinput').value,
                    comment: document.getElementById('textarea').value,
                };

                if (body_part_data[body_part].description === '') {
                    document.getElementById('textinput').focus();
                    tooltip.style.display = 'block';
                    return;
                }
                else {
                    tooltip.style.display = 'none';
                }

                path_element.style.transition = "opacity 0.3s";
                path_element.style.opacity = "1";
                path_element.classList.add("selected");

                document.getElementById('body_part_form').style.display = "none";
            };

            document.getElementById('body_part_form_group_cancel_button').onclick = function () {
                if (is_already_highlighted) {
                    delete body_part_data[body_part];
                }

                document.getElementById('textinput').value = '';
                document.getElementById('textarea').value = '';

                path_element.style.transition = "opacity 0.3s";
                path_element.style.opacity = "";
                path_element.classList.remove("selected");

                document.getElementById('body_part_form').style.display = "none";
                document.getElementById('textinput_tooltip').style.display = 'none';
            };

            event.stopPropagation();
        }
    


    </script>
{#    <script>#}
{#        const form = document.getElementById('register_form');#}
{#        const priorityDisplay = document.getElementById('priority_display');#}
{##}
{#        form.addEventListener('input', () => {#}
{#            const age = parseInt(form.age.value || 0, 10);#}
{#            const diseases = form.diseases.value;#}
{#            const onMedication = form.on_medication.checked;#}
{#            const bloodType = form.blood_type.value;#}
{##}
{#            let priority = 0;#}
{#            if (diseases !== 'None' || onMedication) priority += 1;#}
{#            if (age >= 65 || bloodType === 'AB-') priority += 1;#}
{#            if (['Heart disease', 'Cancer'].includes(diseases)) priority += 1;#}
{##}
{#            priority = Math.min(priority, 2);#}
{#            priorityDisplay.textContent = `Priority: ${priority}`;#}
{#        });#}
{#    </script>#}


</body>
</html>